import Components from './util.js';
const { openExternalUrl } = Components;
window.openExtUrl = new openExternalUrl().openurl;


// Gallery
window.gallerySet = [
  {
    set: [
      {
        url: "./assets/images/about_us/gallery/Client.jpeg",
        title: "Client Partnership",
        description: "Forging partnerships for growth. Enabling OEMs to deliver superior customer delight by ensuring a worry-free riding experience for their customers",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/OfficeOpening.jpeg",
        title: "New Wokspace",
        description: "Our Esteemed Guest, Bishop Kathiroli Manickam (VP & Bishop of Chennai Diocese), graced the inauguration of our new office and led our prayers for a flourishing new chapter in our corporate journey",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/c-1.jpg",
        title: "ISBR Awareness",
        description: "250+ students from ISBR college, Bengaluru participated in creating Road Safety awareness across all major junctions of Bengaluru organized by LetsTagOn in association with Bengaluru city traffic police, which was flagged off and sponsored by RoadMitra.",
        open: false
      },

      {
        url: "./assets/images/about_us/gallery/c-3.jpg",
        title: "Road Safety Event",
        description: "Road Safety event participated by Vimal Singh SV (Founder & CEO), Mrs. Chethana (Founder, LetsTagOn), Mr.Sathish (Angel Investor), Mr.Manish (Chairman of ISBR), Mr.Abdul (Representative of Bangalore Traffic Police)",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/c-4.jpg",
        title: "Our Customer Support",
        description: "Our state of art customer support facility serving customer calls 24/7 through agents who are proficient in multiple languages including English, Hindi, Tamil, Malayalam, Kannada, Telugu and other regional languages.",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/rewards.jpeg",
        title: "Rewards",
        description: "Mr.Arfath Ahmed, service partner of RoadMitra claimed a mixer through reward points (30,000 points)",
        open: false
      },
    ]
  },
  {
    set: [
      {
        url: "./assets/images/about_us/gallery/Conference(1).jpg",
        title: "Conference",
        description: "Our Founder & CEO, Mr. Vimal Singh, spoke on 'Reactive Vs Proactive Emergency Assistance' in the 3rd edition of Mobility Outlook’s ‘Making Mobility Safe, Secure’",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/Training1.jpeg",
        title: "Mecademy",
        description: "Mecademy is our CSR initiative aimed at providing automotive skill development & financial empowerment opportunities to students, teenagers & women from the rural sector",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/Client4.jpeg",
        title: "BikeWo became our client",
        description: "When on-road service compliments the dealership network, Customer satisfaction is a sure outcome !!",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/c-5.jpg",
        title: "EV Training for our mechanics",
        description: "Electric vehicle training to our mechanics by Hero Electric. RoadMitra IS A CERTIFIED SKILL PARTNER OF HERO ELECTRIC",
        open: false
      },
      {
        url: "./assets/images/about_us/gallery/Award_3.jpeg",
        title: "We got 2 Awards",
        description: "Winner of Emobility+ India Fleet Show 2023 Awards under the categories 'Leader in Fleet Maintenance & Repair' and 'Innovative Solutions for Fleet Maintenance'",
        open: false
      },
    ]
  },
  {
    set: [
      {
        url: "./assets/images/landing/yhrc_bg.webp",
        title: "YellowHat riders club",
        description: "YellowHat Riders Club is a community-driven initiative to promote responsible riding among bikers. This platform will also recognize and honor remarkable riders across the country"
      },
      {
        url: "./assets/images/about_us/abouts.webp",
        title: "New Home",
        description: "Our New Home - RoadMitra expands it's footprint with the opening of our new Head Quarter building at Bengaluru, Karnataka"
      },
      {
        url: "./assets/images/about_us/gallery/vivek.jpg",
        title: "Yellow Hat Awards Show",
        description: "The first edition of the YellowHat Awards Show witnessed a huge turnout from bike enthusiasts across the country, with Mr. Vivek Oberoi gracing the occasion as the chief guest"
      },
      {
        url: "./assets/images/about_us/gallery/c-9.jpg",
        title: "KIT Handover",
        description: "Handover of tool kit to our mechanics trained and groomed under MECADEMY."
      },
      {
        url: "./assets/images/about_us/gallery/c-8.jpg",
        title: "Our Towing Partners",
        description: "Our 2 wheeler and 4 wheeler towing truck fleet stationed at the parking yard. We have more than 2000 towing partners across the country."
      },
      {
        url: "./assets/images/about_us/gallery/c-7.jpg",
        title: "Partnership with shell",
        description: "One of our quick lube change Center in partnership with Shell lubricant located in Karnataka."
      },
    ]
  }
]
let galleryDiv = document.getElementById('gallery_images');
let galleryDivTemplate = ``;
for (const [i, x] of gallerySet.entries()) {
  let imgTemplate = ``;
  for (const [j, y] of x.set.entries()) {
    imgTemplate += `<img onclick="selectFrame(${i},${j})" style="scale: .8" data-anim data-centerzoomin src=${y.url} alt="RoadMitra gallery" class="w-100 p-1 mb-10 block galleryImages" src=""/>`;
  }
  galleryDivTemplate += `<div class="col-4 px-5" style="z-index:-1">` + imgTemplate + `</div>`
}
galleryDiv.innerHTML = galleryDivTemplate;
var selectedFrame = {};
window.selectFrame = function selectFrame(index1, index2) {

  for (let i = 0; i < gallerySet.length; i++) {
    for (let j = 0; j < gallerySet.length; j++) {
      gallerySet[i].set[j].open = false;
    }
  }
  gallerySet[index1].set[index2].open = true;
  selectedFrame = gallerySet[index1].set[index2];
  if (document.getElementById('galleryDetails')) {
    document.getElementById('galleryDetails').remove();
  }

  var detailsFrame = `<div id="galleryDetails"
    class="flex g-0 fixed start-0 justify-center align-items-center text-white px-20"
    style="width:100vw; height:100vh;z-index:10;background-color:rgba(0, 0, 0, 0.929);top:0px">
    <div class="flex flex-wrap g-0 crop-width br20 relative justify-center">
    <div class="col-12 pb-3 pb-lg-0 px-4">
      <img style="width:30px;height:30px;z-index:5;" onclick="closeFrame()" class="pointer closemark ms-auto block"
        src="./assets/images/common/close.svg">
    </div>
    <div class="col-12 col-lg-5 relative pt-4 pt-lg-0" style="overflow:hidden">
      <div class="col-12 absolute top-0 w-100 h-100 flex justify-between items-center "
        style="z-index:10">
        <img style="width:30px;background-color: rgba(0, 0, 0, 0.674); position:relative;left:10px;"
          src="./assets/images/common/carousel_left.svg" onclick="previousFrame()"
          class="pointer lg-none">
        <img
          style="width:30px; filter: invert(1);background-color: rgba(255, 255, 255, 0.685); position:relative;right:10px;"
          src="./assets/images/common/carousel_right.svg" onclick="nextFrame()"
          class="pointer lg-none rounded-circle p-1">
      </div>
      <div class="px-4 selectedFrameImageOpen" id="selectedFrameImg">
        <img class="w-100 br10" src="${selectedFrame.url}">
      </div>
    </div>
  
    <div class="col-12 px-4 col-lg-6 pt-5 p-lg-50 text-white flex flex-column justify-between"
      style="font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif!important; overflow:hidden">
      <div id="selectedFrameContent">
        <p id="selectedFrame_title" class="weight500 pt-20 pb-10 pb-lg-30 lh-100">${selectedFrame.title}</p>
        <p id="selectedFrame_description" class="fs-14 weight300" style="line-height: 1.5;">${selectedFrame.description}</p>
      </div>
    </div>
    <div
      class="col-12 crop-width flex fixed weight300 justify-end mb-lg-5 pb-50 pe-4 pe-lg-0"
      style="z-index:100; letter-spacing: 0.5;color: beige;bottom:0px;">
      <p onclick="previousFrame()" class="pointer none lg-block" style="padding-right:40px">← Prev</p>
      <p onclick="nextFrame()" class="pointer none lg-block" style="padding-left:40px">Next →</p>
    </div>
  </div>
      </div>`

  document.getElementById('openGallery').innerHTML += detailsFrame;

  document.getElementById('selectedFrameImg').addEventListener('animationend', function () {
    document.getElementById('selectedFrameContent').classList.add('selectedFrameContentOpen')
  });

}
window.nextFrame = function nextFrame() {
  setTimeout(() => {
    for (let i = 0; i < gallerySet.length; i++) {
      for (let j = 0; j < gallerySet[i].set.length; j++) {
        if (gallerySet[i].set[j].open) {

          gallerySet[i].set[j].open = false;
          if (i === 2 && j === gallerySet[i].set.length - 1) {
            selectedFrame = gallerySet[0].set[0];
            gallerySet[0].set[0].open = true;
            selectFrame(0, 0);
          }
          else {
            if (j === gallerySet[i].set.length - 1) {
              selectedFrame = gallerySet[i + 1].set[0];
              gallerySet[i + 1].set[0].open = true;
              selectFrame(i + 1, 0);
            }
            else {
              selectedFrame = gallerySet[i].set[j + 1];
              gallerySet[i].set[j + 1].open = true;
              selectFrame(i, j + 1);
            }

          }
          return;
        }
      }
    }
  }, 200);

  setTimeout(() => {

    setTimeout(() => {
      document.getElementById('selectedFrameImg').addEventListener('animationend', function () {
        document.getElementById('selectedFrameContent').classList.add('selectedFrameContentOpen')
      });
      document.getElementById('selectedFrameImg').classList.add('selectedFrameImageOpen');
    }, 100);
  }, 200);

}
window.previousFrame = function previousFrame() {
  setTimeout(() => {
    for (let i = 0; i < gallerySet.length; i++) {
      for (let j = 0; j < gallerySet[i].set.length; j++) {
        if (gallerySet[i].set[j].open) {

          gallerySet[i].set[j].open = false;
          if (i === 0 && j === 0) {

            selectedFrame = gallerySet[2].set[gallerySet[2].set.length - 1];
            gallerySet[2].set[gallerySet[2].set.length - 1].open = true;
            selectFrame(2, gallerySet[2].set.length - 1);
          }
          else {
            if (j === 0) {
              selectedFrame = gallerySet[i - 1].set[gallerySet[i - 1].set.length - 1];
              gallerySet[i - 1].set[gallerySet[i - 1].set.length - 1].open = true;
              selectFrame(i - 1, gallerySet[i - 1].set.length - 1);

            }
            else {
              selectedFrame = gallerySet[i].set[j - 1];
              gallerySet[i].set[j - 1].open = true;
              selectFrame(i, j - 1);
            }
          }
          return;
        }
      }
    }
  }, 200);

  setTimeout(() => {
    setTimeout(() => {
      document.getElementById('selectedFrameImg').addEventListener('animationend', function () {
        document.getElementById('selectedFrameContent').classList.add('selectedFrameContentOpen')
      });
      document.getElementById('selectedFrameImg').classList.add('selectedFrameImageOpen');
    }, 100);
  }, 200);
}
window.closeFrame = function closeFrame() {
  document.getElementById('galleryDetails').remove();
}

// Life at RA
let celebrations = [
  {
    img: './assets/images/about_us/lifeatra/life.webp',
    c1: 'Life At RoadMitra',
    alt: 'Life At RoadMitra',
    c2: "At RoadMitra, we work together with enthusiasm and creativity. We like to collaborate and support each other's ideas. Team-building activities make our team stronger and boost our energy. Challenges are opportunities for us to be creative. Together, we make our workplace lively, motivated, and inspiring.",
    active: true,
    opacity: 1,
  },
  {
    img: './assets/images/about_us/lifeatra/festive_spirit.webp',
    c1: 'Festive Spirit',
    alt: 'RoadMitra Festive Spirit',
    c2: 'Our inclusive culture embraces diversity, and we proudly celebrate various cultures within our team through enjoyable Cultural Celebrations. These events feature cultural performances and delectable cuisine, fostering unity and strengthening our cohesive work environment.',
    active: true,
    opacity: 0,
  },
  {
    img: './assets/images/about_us/lifeatra/masterchef.webp',
    c1: 'Masterchef',
    alt: 'RoadMitra Masterchef',
    c2: "Masterchef began as a fun idea among colleagues but has turned into something incredible. Every 1st and 3rd Saturday, employees prepare their favorite dishes and sell them at a slight markup to support orphanages. Any surplus food is donated to those in need near our office. It's making a significant impact, and the food is absolutely delicious!",
    active: false,
    opacity: 0,
  },
  {
    img: './assets/images/about_us/lifeatra/yellow_hat.webp',
    c1: 'Yellow Hat Riders Club',
    alt: 'Yellow Hat Riders Club',
    c2: "The Yellow Hat Riders Club is a gathering of passionate motorcycle enthusiasts who prioritize responsible riding and friendship. They have an open door for riders from diverse backgrounds, emphasizing safety, cherishing thrilling journeys, and nurturing a tight-knit biking community.",
    active: false,
    opacity: 0,
  },
  {
    img: './assets/images/about_us/lifeatra/knowledge_sharing.webp',
    c1: 'Knowledge Sharing sessions',
    alt: 'RoadMitra Knowledge Sharing sessions',
    c2: "As a significant player in the Automobile service industry, we're committed to sharing our knowledge. We conduct weekly meetings to support our team's learning and growth, empowering us to expand our expertise and enhance our job performance.",
    active: false,
    opacity: 0,
  },

  {
    img: './assets/images/about_us/lifeatra/gear_book.webp',
    c1: 'Gear Book',
    alt: 'RoadMitra Gear Book',
    c2: "To promote transparency, we produce a monthly digital magazine called 'Gearbook.' This magazine keeps our team updated on company news and developments, fostering a culture of openness and ensuring everyone is well-informed.",
    active: false,
    opacity: 0,
  }
]
let celebrationsMobileDiv = document.getElementById('celebrations_mobile');
let celebrationsMobileHtml = ``;
for (const c of celebrations) {
  celebrationsMobileHtml += `
  <div class="col-12 flex items-center relative" style="height: calc( 100vh - 65px);background-color: black;overflow:hidden">
      <img style="height:calc( 100vh - 60px)" alt="${c.alt}" src="${c.img}">
      <div id="celebrations_mobile_content" class="col-12 h-100 absolute flex items-center px-30">
      <div class="col-12 px-3 px-lg-0 ps-lg-5">
          <p id="celebrations_mobile_title" class="weight600 pb-10">${c.c1}</p>
          <p id="celebrations_mobile_description" class="weight300 pb-20 col-lg-9" style="line-height:1.7">${c.c2}</p>
      </div>
    </div>
  </div>`;
}
celebrationsMobileDiv.innerHTML = celebrationsMobileHtml;
let items = document.querySelectorAll(".lifeAtRA_carousel_right_item");
let carousel = document.querySelector(".lifeAtRA_carousel");
document.addEventListener("scroll", () => {
  let proportion = carousel.getBoundingClientRect().top / window.innerHeight;
  let index = Math.ceil(-1 * (proportion + 0.5));
  items.forEach((item, i) => {
    item.className = "lifeAtRA_carousel_right_item";
    if (i == index) {
      item.className = "lifeAtRA_carousel_right_item active";
    }
  });
});


// Awards
let carouselPrev = document.querySelector('.left_arrow');
let carouselNext = document.querySelector('.right_arrow');
let CarouselItems = document.querySelectorAll('.carousel_wrapper span');
let currentIndex = 0;
let activeCardTitle = document.getElementById('active_card_title');
let activeCardDescription = document.getElementById('active_card_description');
function updateCarousel() {
  const numItems = CarouselItems.length;

  CarouselItems.forEach((item, index) => {
    let offset = (index - currentIndex + numItems) % numItems;
    if (offset > numItems / 2) {
      offset -= numItems;
    }

    const angle = offset * 35;
    const zOffset = offset === 0 ? 430 : 380;
    const opacity = Math.abs(offset) > 1 ? 0 : 1;

    item.style.transform = `rotateY(${angle}deg) translateZ(${zOffset}px)`;
    item.style.opacity = opacity;
    item.style.visibility = opacity === 0 ? 'hidden' : 'visible';
    item.style.transition = 'transform 0.8s, opacity 0.5s, visibility 0.5s';
  });

  const activeCard = CarouselItems[currentIndex];
  const activeCardLayer = activeCard.querySelector('.award_carousel_details');
  activeCardTitle.textContent = activeCardLayer.querySelector('h5').textContent;
  activeCardDescription.textContent = activeCardLayer.querySelector('p').textContent;
}
carouselPrev.addEventListener('click', function () {
  currentIndex = (currentIndex - 1 + CarouselItems.length) % CarouselItems.length;
  updateCarousel();
});
carouselNext.addEventListener('click', function () {
  currentIndex = (currentIndex + 1) % CarouselItems.length;
  updateCarousel();
});
updateCarousel();